/* 
 * jquery.event.drag - v 2.0.0 
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
(function(d){d.fn.drag=function(i,e,h){var g=typeof i=="string"?i:"",f=d.isFunction(i)?i:d.isFunction(e)?e:null;if(g.indexOf("drag")!==0){g="drag"+g}h=(i==f?e:h)||{};return f?this.bind(g,h,f):this.trigger(g)};var b=d.event,a=b.special,c=a.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:false,drop:true,click:false},datakey:"dragdata",livekey:"livedrag",add:function(g){var f=d.data(this,c.datakey),e=g.data||{};f.related+=1;if(!f.live&&g.selector){f.live=true;b.add(this,"draginit."+c.livekey,c.delegate)}d.each(c.defaults,function(h,i){if(e[h]!==undefined){f[h]=e[h]}})},remove:function(){d.data(this,c.datakey).related-=1},setup:function(){if(d.data(this,c.datakey)){return}var e=d.extend({related:0},c.defaults);d.data(this,c.datakey,e);b.add(this,"mousedown",c.init,e);if(this.attachEvent){this.attachEvent("ondragstart",c.dontstart)}},teardown:function(){if(d.data(this,c.datakey).related){return}d.removeData(this,c.datakey);b.remove(this,"mousedown",c.init);b.remove(this,"draginit",c.delegate);c.textselect(true);if(this.detachEvent){this.detachEvent("ondragstart",c.dontstart)}},init:function(g){var e=g.data,f;if(e.which>0&&g.which!=e.which){return}if(d(g.target).is(e.not)){return}if(e.handle&&!d(g.target).closest(e.handle,g.currentTarget).length){return}e.propagates=1;e.interactions=[c.interaction(this,e)];e.target=g.target;e.pageX=g.pageX;e.pageY=g.pageY;e.dragging=null;f=c.hijack(g,"draginit",e);if(!e.propagates){return}f=c.flatten(f);if(f&&f.length){e.interactions=[];d.each(f,function(){e.interactions.push(c.interaction(this,e))})}e.propagates=e.interactions.length;if(e.drop!==false&&a.drop){a.drop.handler(g,e)}c.textselect(false);b.add(document,"mousemove mouseup",c.handler,e);return false},interaction:function(f,e){return{drag:f,callback:new c.callback(),droppable:[],offset:d(f)[e.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(f){var e=f.data;switch(f.type){case !e.dragging&&"mousemove":if(Math.pow(f.pageX-e.pageX,2)+Math.pow(f.pageY-e.pageY,2)<Math.pow(e.distance,2)){break}f.target=e.target;c.hijack(f,"dragstart",e);if(e.propagates){e.dragging=true}case"mousemove":if(e.dragging){c.hijack(f,"drag",e);if(e.propagates){if(e.drop!==false&&a.drop){a.drop.handler(f,e)}break}f.type="mouseup"}case"mouseup":b.remove(document,"mousemove mouseup",c.handler);if(e.dragging){if(e.drop!==false&&a.drop){a.drop.handler(f,e)}c.hijack(f,"dragend",e)}c.textselect(true);if(e.click===false&&e.dragging){jQuery.event.triggered=true;setTimeout(function(){jQuery.event.triggered=false},20);e.dragging=false}break}},delegate:function(g){var e=[],h,f=d.data(this,"events")||{};d.each(f.live||[],function(j,k){if(k.preType.indexOf("drag")!==0){return}h=d(g.target).closest(k.selector,g.currentTarget)[0];if(!h){return}b.add(h,k.origType+"."+c.livekey,k.origHandler,k.data);if(d.inArray(h,e)<0){e.push(h)}});if(!e.length){return false}return d(e).bind("dragend."+c.livekey,function(){b.remove(this,"."+c.livekey)})},hijack:function(f,m,p,n,h){if(!p){return}var o={event:f.originalEvent,type:f.type},k=m.indexOf("drop")?"drag":"drop",r,j=n||0,g,e,q,l=!isNaN(n)?n:p.interactions.length;f.type=m;f.originalEvent=null;p.results=[];do{if(g=p.interactions[j]){if(m!=="dragend"&&g.cancelled){continue}q=c.properties(f,p,g);g.results=[];d(h||g[k]||p.droppable).each(function(s,i){q.target=i;r=i?b.handle.call(i,f,q):null;if(r===false){if(k=="drag"){g.cancelled=true;p.propagates-=1}if(m=="drop"){g[k][s]=null}}else{if(m=="dropinit"){g.droppable.push(c.element(r)||i)}}if(m=="dragstart"){g.proxy=d(c.element(r)||g.drag)[0]}g.results.push(r);delete f.result;if(m!=="dropinit"){return r}});p.results[j]=c.flatten(g.results);if(m=="dropinit"){g.droppable=c.flatten(g.droppable)}if(m=="dragstart"&&!g.cancelled){q.update()}}}while(++j<l);f.type=o.type;f.originalEvent=o.event;return c.flatten(p.results)},properties:function(g,e,f){var h=f.callback;h.drag=f.drag;h.proxy=f.proxy||f.drag;h.startX=e.pageX;h.startY=e.pageY;h.deltaX=g.pageX-e.pageX;h.deltaY=g.pageY-e.pageY;h.originalX=f.offset.left;h.originalY=f.offset.top;h.offsetX=g.pageX-(e.pageX-h.originalX);h.offsetY=g.pageY-(e.pageY-h.originalY);h.drop=c.flatten((f.drop||[]).slice());h.available=c.flatten((f.droppable||[]).slice());return h},element:function(e){if(e&&(e.jquery||e.nodeType==1)){return e}},flatten:function(e){return d.map(e,function(f){return f&&f.jquery?d.makeArray(f):f&&f.length?c.flatten(f):f})},textselect:function(e){var f=d(document)[e?"unbind":"bind"]("selectstart",c.dontstart);if(f.length==1&&f[0]==document){return}f.attr("unselectable",e?"off":"on").css("MozUserSelect",e?"":"none")},dontstart:function(){return false},callback:function(){}};c.callback.prototype={update:function(){if(a.drop&&this.available.length){d.each(this.available,function(e){a.drop.locate(this,e)})}}};a.draginit=a.dragstart=a.dragend=c})(jQuery);
/* 
 * jquery.event.drop - v 2.0.0 
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */
(function(e){e.fn.drop=function(j,b,i){var f=typeof j=="string"?j:"",h=e.isFunction(j)?j:e.isFunction(b)?b:null;if(f.indexOf("drop")!==0){f="drop"+f}i=(j==h?b:i)||{};return h?this.bind(f,i,h):this.trigger(f)};e.drop=function(b){b=b||{};a.multi=b.multi===true?Infinity:b.multi===false?1:!isNaN(b.multi)?b.multi:a.multi;a.delay=b.delay||a.delay;a.tolerance=e.isFunction(b.tolerance)?b.tolerance:b.tolerance===null?null:a.tolerance;a.mode=b.mode||a.mode||"intersect"};var c=e.event,d=c.special,a=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",livekey:"livedrop",add:function(f){var b=e.data(this,a.datakey);b.related+=1;if(!b.live&&f.selector){b.live=true;c.add(this,"dropinit."+a.livekey,a.delegate)}},remove:function(){e.data(this,a.datakey).related-=1},setup:function(){if(!e.data(this,a.datakey)){e.data(this,a.datakey,{related:0,active:[],anyactive:0,winner:0,location:{}});a.targets.push(this)}},teardown:function(){if(!e.data(this,a.datakey).related){e.removeData(this,a.datakey);c.remove(this,"dropinit",a.delegate);var b=this;a.targets=e.grep(a.targets,function(f){return f!==b})}},handler:function(g,b){var f;if(b){switch(g.type){case"mousedown":f=e(a.targets);if(typeof b.drop=="string"){f=f.filter(b.drop)}f.each(function(){var h=e.data(this,a.datakey);h.active=[];h.anyactive=0;h.winner=0});b.droppable=f;a.delegates=[];d.drag.hijack(g,"dropinit",b);a.delegates=e.unique(d.drag.flatten(a.delegates));break;case"mousemove":a.event=g;a.timer||a.tolerate(b);break;case"mouseup":a.timer=clearTimeout(a.timer);if(b.propagates){d.drag.hijack(g,"drop",b);d.drag.hijack(g,"dropend",b);e.each(a.delegates||[],function(){c.remove(this,"."+a.livekey)})}break}}},delegate:function(i){var b=[],h,f=e.data(this,"events")||{};e.each(f.live||[],function(j,g){if(g.preType.indexOf("drop")===0){h=e(i.currentTarget).find(g.selector);h.length&&h.each(function(){c.add(this,g.origType+"."+a.livekey,g.origHandler,g.data);e.inArray(this,b)<0&&b.push(this)})}});a.delegates.push(b);return b.length?e(b):false},locate:function(l,b){var k=e.data(l,a.datakey),i=e(l),j=i.offset()||{},f=i.outerHeight();i=i.outerWidth();j={elem:l,width:i,height:f,top:j.top,left:j.left,right:j.left+i,bottom:j.top+f};if(k){k.location=j;k.index=b;k.elem=l}return j},contains:function(f,b){return(b[0]||b.left)>=f.left&&(b[0]||b.right)<=f.right&&(b[1]||b.top)>=f.top&&(b[1]||b.bottom)<=f.bottom},modes:{intersect:function(g,b,f){return this.contains(f,[g.pageX,g.pageY])?1000000000:this.modes.overlap.apply(this,arguments)},overlap:function(g,b,f){return Math.max(0,Math.min(f.bottom,b.bottom)-Math.max(f.top,b.top))*Math.max(0,Math.min(f.right,b.right)-Math.max(f.left,b.left))},fit:function(g,b,f){return this.contains(f,b)?1:0},middle:function(g,b,f){return this.contains(f,[b.left+b.width*0.5,b.top+b.height*0.5])?1:0}},sort:function(f,b){return b.winner-f.winner||f.index-b.index},tolerate:function(w){var x,v,t,u,s,l,r=0,q,b=w.interactions.length,i=[a.event.pageX,a.event.pageY],f=a.tolerance||a.modes[a.mode];do{if(q=w.interactions[r]){if(!q){return}q.drop=[];s=[];l=q.droppable.length;if(f){t=a.locate(q.proxy)}x=0;do{if(v=q.droppable[x]){u=e.data(v,a.datakey);if(v=u.location){u.winner=f?f.call(a,a.event,t,v):a.contains(v,i)?1:0;s.push(u)}}}while(++x<l);s.sort(a.sort);x=0;do{if(u=s[x]){if(u.winner&&q.drop.length<a.multi){if(!u.active[r]&&!u.anyactive){if(d.drag.hijack(a.event,"dropstart",w,r,u.elem)[0]!==false){u.active[r]=1;u.anyactive+=1}else{u.winner=0}}u.winner&&q.drop.push(u.elem)}else{if(u.active[r]&&u.anyactive==1){d.drag.hijack(a.event,"dropend",w,r,u.elem);u.active[r]=0;u.anyactive-=1}}}}while(++x<l)}}while(++r<b);if(a.last&&i[0]==a.last.pageX&&i[1]==a.last.pageY){delete a.timer}else{a.timer=setTimeout(function(){a.tolerate(w)},a.delay)}a.last=a.event}};d.dropinit=d.dropstart=d.dropend=a})(jQuery);(function(d){d.extend(true,window,{Slick:{Event:a,EventData:b,Range:e,EditorLock:c,GlobalEditorLock:new c()}});function b(){var f=false;var g=false;this.stopPropagation=function(){f=true};this.isPropagationStopped=function(){return f};this.stopImmediatePropagation=function(){g=true};this.isImmediatePropagationStopped=function(){return g}}function a(){var f=[];this.subscribe=function(g){f.push(g)};this.unsubscribe=function(h){for(var g=f.length-1;g>=0;g--){if(f[g]===h){f.splice(g,1)}}};this.notify=function(h,g){var m;var l;var k;if(arguments.length===2){m=h;l=g}else{m=new b();l=h}for(var j=0;j<f.length&&!(m.isPropagationStopped()||m.isImmediatePropagationStopped());j++){k=f[j].call(this,m,l)}return k}}function e(g,f,h,i){if(h===undefined&&i===undefined){h=g;i=f}this.fromRow=Math.min(g,h);this.fromCell=Math.min(f,i);this.toRow=Math.max(g,h);this.toCell=Math.max(f,i);this.isSingleRow=function(){return this.fromRow==this.toRow};this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell};this.contains=function(k,j){return k>=this.fromRow&&k<=this.toRow&&j>=this.fromCell&&j<=this.toCell};this.toString=function(){if(this.isSingleCell()){return"("+this.fromRow+":"+this.fromCell+")"}else{return"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}}function c(){var f=null;this.isActive=function i(l){return(l?f===l:f!==null)};this.activate=function h(l){if(l===f){return}if(f!==null){throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController"}if(!l.commitCurrentEdit){throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()"}if(!l.cancelCurrentEdit){throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()"}f=l};this.deactivate=function j(l){if(f!==l){throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one"}f=null};this.commitCurrentEdit=function g(){return(f?f.commitCurrentEdit():true)};this.cancelCurrentEdit=function k(){return(f?f.cancelCurrentEdit():true)}}})(jQuery);(function(a){var b={SelectorCellFormatter:function(g,d,f,e,c){return(!c?"":g)},PercentCompleteCellFormatter:function(g,d,f,e,c){if(f==null||f===""){return"-"}else{if(f<50){return"<span style='color:red;font-weight:bold;'>"+f+"%</span>"}else{return"<span style='color:green'>"+f+"%</span>"}}},GraphicalPercentCompleteCellFormatter:function(h,d,g,f,c){if(g==null||g===""){return""}var e;if(g<30){e="red"}else{if(g<70){e="silver"}else{e="green"}}return"<span class='percent-complete-bar' style='background:"+e+";width:"+g+"%'></span>"},YesNoCellFormatter:function(g,d,f,e,c){return f?"Yes":"No"},BoolCellFormatter:function(g,d,f,e,c){return f?"<img src='../images/tick.png'>":""},TaskNameFormatter:function(h,d,g,e,c){var f="<span style='display:inline-block;height:1px;width:"+(2+15*c.indent)+"px'></span>";return f+" <img src='../images/expand.gif'>&nbsp;"+g},ResourcesFormatter:function(h,d,f,e,c){var g=c.resources;if(!g||g.length==0){return""}if(e.width<50){return(g.length>1?"<center><img src='../images/user_identity_plus.gif' ":"<center><img src='../images/user_identity.gif' ")+" title='"+g.join(", ")+"'></center>"}else{return g.join(", ")}},StarFormatter:function(g,d,f,e,c){return(f)?"<img src='../images/bullet_star.png' align='absmiddle'>":""},TextCellEditor:function(d){var f;var c;var e=this;this.init=function(){f=a("<INPUT type=text class='editor-text' />").appendTo(d.container).bind("keydown.nav",function(g){if(g.keyCode===a.ui.keyCode.LEFT||g.keyCode===a.ui.keyCode.RIGHT){g.stopImmediatePropagation()}}).focus().select()};this.destroy=function(){f.remove()};this.focus=function(){f.focus()};this.getValue=function(){return f.val()};this.setValue=function(g){f.val(g)};this.loadValue=function(g){c=g[d.column.field]||"";f.val(c);f[0].defaultValue=c;f.select()};this.serializeValue=function(){return f.val()};this.applyValue=function(g,h){g[d.column.field]=h};this.isValueChanged=function(){return(!(f.val()==""&&c==null))&&(f.val()!=c)};this.validate=function(){if(d.column.validator){var g=d.column.validator(f.val());if(!g.valid){return g}}return{valid:true,msg:null}};this.init()},IntegerCellEditor:function(d){var f;var c;var e=this;this.init=function(){f=a("<INPUT type=text class='editor-text' />");f.bind("keydown.nav",function(g){if(g.keyCode===a.ui.keyCode.LEFT||g.keyCode===a.ui.keyCode.RIGHT){g.stopImmediatePropagation()}});f.appendTo(d.container);f.focus().select()};this.destroy=function(){f.remove()};this.focus=function(){f.focus()};this.loadValue=function(g){c=g[d.column.field];f.val(c);f[0].defaultValue=c;f.select()};this.serializeValue=function(){return parseInt(f.val(),10)||0};this.applyValue=function(g,h){g[d.column.field]=h};this.isValueChanged=function(){return(!(f.val()==""&&c==null))&&(f.val()!=c)};this.validate=function(){if(isNaN(f.val())){return{valid:false,msg:"Please enter a valid integer"}}return{valid:true,msg:null}};this.init()},DateCellEditor:function(d){var g;var c;var e=this;var f=false;this.init=function(){g=a("<INPUT type=text class='editor-text' />");g.appendTo(d.container);g.focus().select();g.datepicker({showOn:"button",buttonImageOnly:true,buttonImage:"../images/calendar.gif",beforeShow:function(){f=true},onClose:function(){f=false}});g.width(g.width()-18)};this.destroy=function(){a.datepicker.dpDiv.stop(true,true);g.datepicker("hide");g.datepicker("destroy");g.remove()};this.show=function(){if(f){a.datepicker.dpDiv.stop(true,true).show()}};this.hide=function(){if(f){a.datepicker.dpDiv.stop(true,true).hide()}};this.position=function(h){if(!f){return}a.datepicker.dpDiv.css("top",h.top+30).css("left",h.left)};this.focus=function(){g.focus()};this.loadValue=function(h){c=h[d.column.field];g.val(c);g[0].defaultValue=c;g.select()};this.serializeValue=function(){return g.val()};this.applyValue=function(h,i){h[d.column.field]=i};this.isValueChanged=function(){return(!(g.val()==""&&c==null))&&(g.val()!=c)};this.validate=function(){return{valid:true,msg:null}};this.init()},YesNoSelectCellEditor:function(e){var d;var c;var f=this;this.init=function(){d=a("<SELECT tabIndex='0' class='editor-yesno'><OPTION value='yes'>Yes</OPTION><OPTION value='no'>No</OPTION></SELECT>");d.appendTo(e.container);d.focus()};this.destroy=function(){d.remove()};this.focus=function(){d.focus()};this.loadValue=function(g){d.val((c=g[e.column.field])?"yes":"no");d.select()};this.serializeValue=function(){return(d.val()=="yes")};this.applyValue=function(g,h){g[e.column.field]=h};this.isValueChanged=function(){return(d.val()!=c)};this.validate=function(){return{valid:true,msg:null}};this.init()},YesNoCheckboxCellEditor:function(e){var d;var c;var f=this;this.init=function(){d=a("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>");d.appendTo(e.container);d.focus()};this.destroy=function(){d.remove()};this.focus=function(){d.focus()};this.loadValue=function(g){c=g[e.column.field];if(c){d.attr("checked","checked")}else{d.removeAttr("checked")}};this.serializeValue=function(){return d.attr("checked")};this.applyValue=function(g,h){g[e.column.field]=h};this.isValueChanged=function(){return(d.attr("checked")!=c)};this.validate=function(){return{valid:true,msg:null}};this.init()},PercentCompleteCellEditor:function(d){var g,f;var c;var e=this;this.init=function(){g=a("<INPUT type=text class='editor-percentcomplete' />");g.width(a(d.container).innerWidth()-25);g.appendTo(d.container);f=a("<div class='editor-percentcomplete-picker' />").appendTo(d.container);f.append("<div class='editor-percentcomplete-helper'><div class='editor-percentcomplete-wrapper'><div class='editor-percentcomplete-slider' /><div class='editor-percentcomplete-buttons' /></div></div>");f.find(".editor-percentcomplete-buttons").append("<button val=0>Not started</button><br/><button val=50>In Progress</button><br/><button val=100>Complete</button>");g.focus().select();f.find(".editor-percentcomplete-slider").slider({orientation:"vertical",range:"min",value:c,slide:function(h,i){g.val(i.value)}});f.find(".editor-percentcomplete-buttons button").bind("click",function(h){g.val(a(this).attr("val"));f.find(".editor-percentcomplete-slider").slider("value",a(this).attr("val"))})};this.destroy=function(){g.remove();f.remove()};this.focus=function(){g.focus()};this.loadValue=function(h){g.val(c=h[d.column.field]);g.select()};this.serializeValue=function(){return parseInt(g.val(),10)||0};this.applyValue=function(h,i){h[d.column.field]=i};this.isValueChanged=function(){return(!(g.val()==""&&c==null))&&((parseInt(g.val(),10)||0)!=c)};this.validate=function(){if(isNaN(parseInt(g.val(),10))){return{valid:false,msg:"Please enter a valid positive number"}}return{valid:true,msg:null}};this.init()},StarCellEditor:function(e){var g;var d;var f=this;function c(h){if(h.type=="keydown"&&h.which!=32){return}if(g.css("opacity")=="1"){g.css("opacity",0.5)}else{g.css("opacity",1)}h.preventDefault();h.stopPropagation();return false}this.init=function(){g=a("<IMG src='../images/bullet_star.png' align=absmiddle tabIndex=0 title='Click or press Space to toggle' />").bind("click keydown",c).appendTo(e.container).focus()};this.destroy=function(){g.unbind("click keydown",c);g.remove()};this.focus=function(){g.focus()};this.loadValue=function(h){d=h[e.column.field];g.css("opacity",d?1:0.2)};this.serializeValue=function(){return(g.css("opacity")=="1")};this.applyValue=function(h,i){h[e.column.field]=i};this.isValueChanged=function(){return d!=(g.css("opacity")=="1")};this.validate=function(){return{valid:true,msg:null}};this.init()},LongTextCellEditor:function(d){var g,f;var c;var e=this;this.init=function(){var h=a("body");f=a("<DIV style='z-index:10000;position:absolute;background:white;padding:5px;border:3px solid gray; -moz-border-radius:10px; border-radius:10px;'/>").appendTo(h);g=a("<TEXTAREA hidefocus rows=5 style='backround:white;width:250px;height:80px;border:0;outline:0'>").appendTo(f);a("<DIV style='text-align:right'><BUTTON>Save</BUTTON><BUTTON>Cancel</BUTTON></DIV>").appendTo(f);f.find("button:first").bind("click",this.save);f.find("button:last").bind("click",this.cancel);g.bind("keydown",this.handleKeyDown);e.position(d.position);g.focus().select()};this.handleKeyDown=function(h){if(h.which==a.ui.keyCode.ENTER&&h.ctrlKey){e.save()}else{if(h.which==a.ui.keyCode.ESCAPE){h.preventDefault();e.cancel()}else{if(h.which==a.ui.keyCode.TAB&&h.shiftKey){h.preventDefault();grid.navigatePrev()}else{if(h.which==a.ui.keyCode.TAB){h.preventDefault();grid.navigateNext()}}}}};this.save=function(){d.commitChanges()};this.cancel=function(){g.val(c);d.cancelChanges()};this.hide=function(){f.hide()};this.show=function(){f.show()};this.position=function(h){f.css("top",h.top-5).css("left",h.left-5)};this.destroy=function(){f.remove()};this.focus=function(){g.focus()};this.loadValue=function(h){g.val(c=h[d.column.field]);g.select()};this.serializeValue=function(){return g.val()};this.applyValue=function(h,i){h[d.column.field]=i};this.isValueChanged=function(){return(!(g.val()==""&&c==null))&&(g.val()!=c)};this.validate=function(){return{valid:true,msg:null}};this.init()}};a.extend(window,b)})(jQuery);(function(b){b.extend(true,window,{Slick:{CellRangeDecorator:a}});function a(g,d){var f;var h={selectionCss:{zIndex:"9999",border:"2px dashed red"}};d=b.extend(true,{},h,d);function c(i){if(!f){f=b("<div></div>",{css:d.selectionCss}).css("position","absolute").appendTo(g.getCanvasNode())}var k=g.getCellNodeBox(i.fromRow,i.fromCell);var j=g.getCellNodeBox(i.toRow,i.toCell);f.css({top:k.top-1,left:k.left-1,height:j.bottom-k.top-2,width:j.right-k.left-2});return f}function e(){if(f){f.remove();f=null}}b.extend(this,{show:c,hide:e})}})(jQuery);(function(b){b.extend(true,window,{Slick:{CellRangeSelector:a}});function a(n){var i;var g;var m;var d;var h=this;var e={selectionCss:{border:"2px dashed blue"}};function l(o){n=b.extend(true,{},e,n);d=new Slick.CellRangeDecorator(o,n);i=o;g=i.getCanvasNode();i.onDragStart.subscribe(f);i.onDrag.subscribe(c);i.onDragEnd.subscribe(j)}function k(){i.onDragStart.unsubscribe(f);i.onDrag.unsubscribe(c);i.onDragEnd.unsubscribe(j)}function f(q,p){var o=i.getCellFromEvent(q);if(h.onBeforeCellRangeSelected.notify(o)!==false){if(i.canCellBeSelected(o.row,o.cell)){m=true;q.stopImmediatePropagation()}}if(!m){return}var r=i.getCellFromPoint(p.startX-b(g).offset().left,p.startY-b(g).offset().top);p.range={start:r,end:{}};return d.show(new Slick.Range(r.row,r.cell))}function c(q,o){if(!m){return}q.stopImmediatePropagation();var p=i.getCellFromPoint(q.pageX-b(g).offset().left,q.pageY-b(g).offset().top);if(!i.canCellBeSelected(p.row,p.cell)){return}o.range.end=p;d.show(new Slick.Range(o.range.start.row,o.range.start.cell,p.row,p.cell))}function j(p,o){if(!m){return}m=false;p.stopImmediatePropagation();d.hide();h.onCellRangeSelected.notify({range:new Slick.Range(o.range.start.row,o.range.start.cell,o.range.end.row,o.range.end.cell)})}b.extend(this,{init:l,destroy:k,onBeforeCellRangeSelected:new Slick.Event(),onCellRangeSelected:new Slick.Event()})}})(jQuery);(function(b){b.extend(true,window,{Slick:{CellSelectionModel:a}});function a(r){var l;var i;var g=[];var k=this;var e=new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}});var n;var f={selectActiveCell:true};function o(s){n=b.extend(true,{},f,r);l=s;i=l.getCanvasNode();l.onActiveCellChanged.subscribe(h);s.registerPlugin(e);e.onCellRangeSelected.subscribe(p);e.onBeforeCellRangeSelected.subscribe(q)}function m(){l.onActiveCellChanged.unsubscribe(h);e.onCellRangeSelected.unsubscribe(p);e.onBeforeCellRangeSelected.unsubscribe(q);l.unregisterPlugin(e)}function d(t){var s=[];for(var u=0;u<t.length;u++){var v=t[u];if(l.canCellBeSelected(v.fromRow,v.fromCell)&&l.canCellBeSelected(v.toRow,v.toCell)){s.push(v)}}return s}function c(s){g=d(s);k.onSelectedRangesChanged.notify(g)}function j(){return g}function q(t,s){if(l.getEditorLock().isActive()){t.stopPropagation();return false}}function p(t,s){c([s.range])}function h(t,s){if(n.selectActiveCell){c([new Slick.Range(s.row,s.cell)])}}b.extend(this,{getSelectedRanges:j,setSelectedRanges:c,init:o,destroy:m,onSelectedRangesChanged:new Slick.Event()})}})(jQuery);(function(b){b.extend(true,window,{Slick:{RowSelectionModel:a}});function a(e){var o;var l=[];var h=this;var n;var p={selectActiveRow:true};function q(u){n=b.extend(true,{},p,e);o=u;o.onActiveCellChanged.subscribe(s);o.onKeyDown.subscribe(k);o.onClick.subscribe(j)}function t(){o.onActiveCellChanged.unsubscribe(s);o.onKeyDown.unsubscribe(k);o.onClick.unsubscribe(j())}function f(u){var x=[];for(var w=0;w<u.length;w++){for(var v=u[w].fromRow;v<=u[w].toRow;v++){x.push(v)}}return x}function g(x){var v=[];var u=o.getColumns().length-1;for(var w=0;w<x.length;w++){v.push(new Slick.Range(x[w],0,x[w],u))}return v}function r(x,w){var u,v=[];for(u=x;u<=w;u++){v.push(u)}for(u=w;u<x;u++){v.push(u)}return v}function d(){return f(l)}function i(u){c(g(u))}function c(u){l=u;h.onSelectedRangesChanged.notify(l)}function m(){return l}function s(v,u){if(n.selectActiveRow){c([new Slick.Range(u.row,0,u.row,o.getColumns().length-1)])}}function k(y){var v=o.getActiveCell();if(v&&y.shiftKey&&!y.ctrlKey&&!y.altKey&&!y.metaKey&&(y.which==38||y.which==40)){var x=d();x.sort(function(z,A){return z-A});if(!x.length){x=[v.row]}var w=x[0];var u=x[x.length-1];if(y.which==40){if(v.row<u||w==u){u++;o.scrollRowIntoView(u)}else{w++;o.scrollRowIntoView(w)}}else{if(v.row<u){u--;o.scrollRowIntoView(u)}else{w--;o.scrollRowIntoView(w)}}x=r(w,u);l=g(x);c(l);y.preventDefault();y.stopPropagation();return true}return false}function j(z){var v=o.getCellFromEvent(z);if(!v||!o.canCellBeSelected(v.row,v.cell)){return false}var x=f(l);var u=b.inArray(v.row,x);if(!z.ctrlKey&&!z.shiftKey&&!z.metaKey){return false}else{if(o.getOptions().multiSelect){if(u===-1&&(z.ctrlKey||z.metaKey)){x.push(v.row);o.setActiveCell(v.row,v.cell)}else{if(u!==-1&&(z.ctrlKey||z.metaKey)){x=b.grep(x,function(D,C){return(D!==v.row)});o.setActiveCell(v.row,v.cell)}else{if(x.length&&z.shiftKey){var y=x.pop();var B=Math.min(v.row,y);var A=Math.max(v.row,y);x=[];for(var w=B;w<=A;w++){if(w!==y){x.push(w)}}x.push(y);o.setActiveCell(v.row,v.cell)}}}}}l=g(x);c(l);z.stopImmediatePropagation();return true}b.extend(this,{getSelectedRows:d,setSelectedRows:i,getSelectedRanges:m,setSelectedRanges:c,init:q,destroy:t,onSelectedRangesChanged:new Slick.Event()})}})(jQuery);(function(b){b.extend(true,window,{Slick:{AutoTooltips:a}});function a(e){var d;var c=this;var i={maxToolTipLength:null};function h(j){e=b.extend(true,{},i,e);d=j;d.onMouseEnter.subscribe(g)}function f(){d.onMouseEnter.subscribe(g)}function g(m,k){var j=d.getCellFromEvent(m);if(j){var l=d.getCellNode(j.row,j.cell);if(b(l).innerWidth()<l.scrollWidth){var n=b.trim(b(l).text());if(e.maxToolTipLength&&n.length>e.maxToolTipLength){n=n.substr(0,e.maxToolTipLength-3)+"..."}b(l).attr("title",n)}else{b(l).attr("title","")}}}b.extend(this,{init:h,destroy:f})}})(jQuery);(function(a){a.extend(true,window,{Slick:{CellCopyManager:b}});function b(){var d;var c=this;var h;function j(k){d=k;d.onKeyDown.subscribe(f)}function g(){d.onKeyDown.unsubscribe(f)}function f(m,l){var k;if(!d.getEditorLock().isActive()){if(m.which==a.ui.keyCode.ESCAPE){if(h){m.preventDefault();e();c.onCopyCancelled.notify({ranges:h});h=null}}if(m.which==67&&m.ctrlKey){k=d.getSelectionModel().getSelectedRanges();if(k.length!=0){m.preventDefault();h=k;i(k);c.onCopyCells.notify({ranges:k})}}if(m.which==86&&m.ctrlKey){if(h){m.preventDefault();e();k=d.getSelectionModel().getSelectedRanges();c.onPasteCells.notify({from:h,to:k});h=null}}}}function i(l){var p={};for(var o=0;o<l.length;o++){for(var n=l[o].fromRow;n<=l[o].toRow;n++){p[n]={};for(var m=l[o].fromCell;m<=l[o].toCell;m++){p[n][columns[m].id]="copied"}}}d.setCellCssStyles("copy-manager",p)}function e(){d.removeCellCssStyles("copy-manager")}a.extend(this,{init:j,destroy:g,clearCopySelection:e,onCopyCells:new Slick.Event(),onCopyCancelled:new Slick.Event(),onPasteCells:new Slick.Event()})}})(jQuery);(function(a){a.extend(true,window,{Slick:{CheckboxSelectColumn:b}});function b(o){var h;var g=this;var n={};var e={columnId:"_checkbox_selector",cssClass:null,toolTip:"Select/Deselect All",width:30};var l=a.extend(true,{},e,o);function m(p){h=p;h.onSelectedRowsChanged.subscribe(i);h.onClick.subscribe(f);h.onHeaderClick.subscribe(k)}function j(){h.onSelectedRowsChanged.unsubscribe(i);h.onClick.unsubscribe(f);h.onHeaderClick.unsubscribe(k)}function i(t,p){var s=h.getSelectedRows();var r={},u,q;for(q=0;q<s.length;q++){u=s[q];r[u]=true;if(r[u]!==n[u]){h.invalidateRow(u);delete n[u]}}for(q in n){h.invalidateRow(q)}n=r;h.render();if(s.length==h.getDataLength()){h.updateColumnHeader(l.columnId,"<input type='checkbox' checked='checked'>",l.toolTip)}else{h.updateColumnHeader(l.columnId,"<input type='checkbox'>",l.toolTip)}}function f(q,p){if(h.getColumns()[p.cell].id===l.columnId&&a(q.target).is(":checkbox")){if(h.getEditorLock().isActive()&&!h.getEditorLock().commitCurrentEdit()){q.preventDefault();q.stopImmediatePropagation();return}if(n[p.row]){h.setSelectedRows(a.grep(h.getSelectedRows(),function(r){return r!=p.row}))}else{h.setSelectedRows(h.getSelectedRows().concat(p.row))}q.stopPropagation();q.stopImmediatePropagation()}}function k(s,p){if(p.column.id==l.columnId&&a(s.target).is(":checkbox")){if(h.getEditorLock().isActive()&&!h.getEditorLock().commitCurrentEdit()){s.preventDefault();s.stopImmediatePropagation();return}if(a(s.target).is(":checked")){var r=[];for(var q=0;q<h.getDataLength();q++){r.push(q)}h.setSelectedRows(r)}else{h.setSelectedRows([])}h.invalidate();s.stopPropagation();s.stopImmediatePropagation()}}function c(){return{id:l.columnId,name:"<input type='checkbox'>",toolTip:l.toolTip,field:"sel",width:l.width,unselectable:true,resizable:false,sortable:false,cssClass:l.cssClass,formatter:d}}function d(t,q,s,r,p){if(p){return n[t]?"<input type='checkbox' checked='checked'>":"<input type='checkbox'>"}return null}a.extend(this,{init:m,destroy:j,getColumnDefinition:c})}})(jQuery);(function(a){a.extend(true,window,{Slick:{RowMoveManager:b}});function b(){var g;var e;var k;var f=this;function j(l){g=l;e=g.getCanvasNode();g.onDragStart.subscribe(d);g.onDrag.subscribe(c);g.onDragEnd.subscribe(h)}function i(){g.onDragStart.unsubscribe(d);g.onDrag.unsubscribe(c);g.onDragEnd.unsubscribe(h)}function d(p,m){var l=g.getCellFromEvent(p);if(g.getEditorLock().isActive()||!/move|selectAndMove/.test(g.getColumns()[l.cell].behavior)){return false}k=true;p.stopImmediatePropagation();var o=g.getSelectedRows();if(o.length==0||a.inArray(l.row,o)==-1){o=[l.row];g.setSelectedRows(o)}var n=g.getOptions().rowHeight;m.selectedRows=o;m.selectionProxy=a("<div class='slick-reorder-proxy'/>").css("position","absolute").css("zIndex","99999").css("width",a(e).innerWidth()).css("height",n*o.length).appendTo(e);m.guide=a("<div class='slick-reorder-guide'/>").css("position","absolute").css("zIndex","99998").css("width",a(e).innerWidth()).css("top",-1000).appendTo(e);m.insertBefore=-1;return a("<div></div>").appendTo(e)}function c(p,l){if(!k){return}p.stopImmediatePropagation();var o=p.pageY-a(e).offset().top;l.selectionProxy.css("top",o-5);var m=Math.max(0,Math.min(Math.round(o/g.getOptions().rowHeight),g.getDataLength()));if(m!==l.insertBefore){var n={rows:l.selectedRows,insertBefore:m};if(f.onBeforeMoveRows.notify(n)===false){l.guide.css("top",-1000);l.canMove=false}else{l.guide.css("top",m*g.getOptions().rowHeight);l.canMove=true}l.insertBefore=m}}function h(n,l){if(!k){return}k=false;n.stopImmediatePropagation();l.guide.remove();l.selectionProxy.remove();if(l.canMove){var m={rows:l.selectedRows,insertBefore:l.insertBefore};f.onMoveRows.notify(m)}}a.extend(this,{onBeforeMoveRows:new Slick.Event(),onMoveRows:new Slick.Event(),init:j,destroy:i})}})(jQuery);if(typeof jQuery==="undefined"){throw"SlickGrid requires jquery module to be loaded"}if(!jQuery.fn.drag){throw"SlickGrid requires jquery.event.drag module to be loaded"}if(typeof Slick==="undefined"){throw"slick.core.js not loaded"}(function($){$.extend(true,window,{Slick:{Grid:SlickGrid}});var scrollbarDimensions;function SlickGrid(container,data,columns,options){var defaults={rowHeight:25,defaultColumnWidth:80,enableAddRow:false,leaveSpaceForNewRows:false,editable:false,autoEdit:true,enableCellNavigation:true,enableCellRangeSelection:false,enableColumnReorder:true,asyncEditorLoading:false,asyncEditorLoadDelay:100,forceFitColumns:false,enableAsyncPostRender:false,asyncPostRenderDelay:60,autoHeight:false,editorLock:Slick.GlobalEditorLock,showHeaderRow:false,headerRowHeight:25,showTopPanel:false,topPanelHeight:25,syncColumnCellResize:false,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:true},gridData;var columnDefaults={name:"",resizable:true,sortable:false,minWidth:30,rerenderOnResize:false,unselectable:false};var maxSupportedCssHeight;var th;var h;var ph;var n;var cj;var page=0;var offset=0;var scrollDir=1;var $container;var uid="slickgrid_"+Math.round(1000000*Math.random());var self=this;var $headerScroller;var $headers;var $headerRow,$headerRowScroller;var $topPanelScroller;var $topPanel;var $viewport;var $canvas;var $style;var stylesheet;var viewportH,viewportW;var viewportHasHScroll;var headerColumnWidthDiff,headerColumnHeightDiff,cellWidthDiff,cellHeightDiff;var absoluteColumnMinWidth;var activeRow,activeCell;var activeCellNode=null;var currentEditor=null;var serializedEditorValue;var editController;var rowsCache={};var renderedRows=0;var numVisibleRows;var prevScrollTop=0;var scrollTop=0;var lastRenderedScrollTop=0;var prevScrollLeft=0;var avgRowRenderTime=10;var selectionModel;var selectedRows=[];var plugins=[];var cellCssClasses={};var columnsById={};var sortColumnId;var sortAsc=true;var h_editorLoader=null;var h_render=null;var h_postrender=null;var postProcessedRows={};var postProcessToRow=null;var postProcessFromRow=null;var counter_rows_rendered=0;var counter_rows_removed=0;function init(){$container=$(container);gridData=data;maxSupportedCssHeight=getMaxSupportedCssHeight();scrollbarDimensions=scrollbarDimensions||measureScrollbar();options=$.extend({},defaults,options);columnDefaults.width=options.defaultColumnWidth;if(options.enableColumnReorder&&!$.fn.sortable){throw new Error('SlickGrid\'s "enableColumnReorder = true" option requires jquery-ui.sortable module to be loaded')}editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit};$container.empty().attr("tabIndex",0).attr("hideFocus",true).css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget");if(!/relative|absolute|fixed/.test($container.css("position"))){$container.css("position","relative")}$headerScroller=$("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container);$headers=$("<div class='slick-header-columns' style='width:100000px; left:-10000px' />").appendTo($headerScroller);$headerRowScroller=$("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container);$headerRow=$("<div class='slick-headerrow-columns' style='width:100000px;' />").appendTo($headerRowScroller);$topPanelScroller=$("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container);$topPanel=$("<div class='slick-top-panel' style='width:100000px' />").appendTo($topPanelScroller);if(!options.showTopPanel){$topPanelScroller.hide()}if(!options.showHeaderRow){$headerRowScroller.hide()}$viewport=$("<div class='slick-viewport' tabIndex='0' hideFocus style='width:100%;overflow-x:auto;outline:0;position:relative;overflow-y:auto;'>").appendTo($container);$canvas=$("<div class='grid-canvas' tabIndex='0' hideFocus />").appendTo($viewport);measureCellPaddingAndBorder();resizeViewport();disableSelection($headers);$viewport.bind("selectstart.ui",function(event){return $(event.target).is("input,textarea")});createColumnHeaders();setupColumnSort();createCssRules();resizeAndRender();bindAncestorScrollEvents();$viewport.bind("scroll.slickgrid",handleScroll);$container.bind("resize.slickgrid",resizeAndRender);$headerScroller.bind("contextmenu.slickgrid",handleHeaderContextMenu).bind("click.slickgrid",handleHeaderClick);$canvas.bind("keydown.slickgrid",handleKeyDown).bind("click.slickgrid",handleClick).bind("dblclick.slickgrid",handleDblClick).bind("contextmenu.slickgrid",handleContextMenu).bind("draginit",handleDragInit).bind("dragstart",handleDragStart).bind("drag",handleDrag).bind("dragend",handleDragEnd);$canvas.delegate(".slick-cell","mouseenter",handleMouseEnter);$canvas.delegate(".slick-cell","mouseleave",handleMouseLeave)}function registerPlugin(plugin){plugins.unshift(plugin);plugin.init(self)}function unregisterPlugin(plugin){for(var i=plugins.length;i>=0;i--){if(plugins[i]===plugin){if(plugins[i].destroy){plugins[i].destroy()}plugins.splice(i,1);break}}}function setSelectionModel(model){if(selectionModel){selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged);if(selectionModel.destroy){selectionModel.destroy()}}selectionModel=model;selectionModel.init(self);selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged)}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var $c=$("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body");var dim={width:$c.width()-$c[0].clientWidth,height:$c.height()-$c[0].clientHeight};$c.remove();return dim}function setCanvasWidth(width){$canvas.width(width);viewportHasHScroll=(width>viewportW-scrollbarDimensions.width)}function disableSelection($target){if($target&&$target.jquery){$target.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false})}}function getMaxSupportedCssHeight(){var increment=1000000;var supportedHeight=0;var testUpTo=($.browser.mozilla)?5000000:1000000000;var div=$("<div style='display:none' />").appendTo(document.body);while(supportedHeight<=testUpTo){div.css("height",supportedHeight+increment);if(div.height()!==supportedHeight+increment){break}else{supportedHeight+=increment}}div.remove();return supportedHeight}function bindAncestorScrollEvents(){var elem=$canvas[0];while((elem=elem.parentNode)!=document.body){if(elem==$viewport[0]||elem.scrollWidth!=elem.clientWidth||elem.scrollHeight!=elem.clientHeight){$(elem).bind("scroll.slickgrid",handleActiveCellPositionChange)}}}function unbindAncestorScrollEvents(){$canvas.parents().unbind("scroll.slickgrid")}function updateColumnHeader(columnId,title,toolTip){var idx=getColumnIndex(columnId);var $header=$headers.children().eq(idx);if($header){columns[idx].name=title;columns[idx].toolTip=toolTip;$header.attr("title",toolTip||title||"").children().eq(0).html(title)}}function getHeaderRow(){return $headerRow[0]}function getHeaderRowColumn(columnId){var idx=getColumnIndex(columnId);var $header=$headerRow.children().eq(idx);return $header&&$header[0]}function createColumnHeaders(){var i;function hoverBegin(){$(this).addClass("ui-state-hover")}function hoverEnd(){$(this).removeClass("ui-state-hover")}$headers.empty();$headerRow.empty();columnsById={};for(i=0;i<columns.length;i++){var m=columns[i]=$.extend({},columnDefaults,columns[i]);columnsById[m.id]=i;var header=$("<div class='ui-state-default slick-header-column' id='"+uid+m.id+"' />").html("<span class='slick-column-name'>"+m.name+"</span>").width((m.currentWidth||m.width)-headerColumnWidthDiff).attr("title",m.toolTip||m.name||"").data("fieldId",m.id).appendTo($headers);if(options.enableColumnReorder||m.sortable){header.hover(hoverBegin,hoverEnd)}if(m.sortable){header.append("<span class='slick-sort-indicator' />")}if(options.showHeaderRow){$("<div class='ui-state-default slick-headerrow-column c"+i+"'></div>").appendTo($headerRow)}}setSortColumn(sortColumnId,sortAsc);setupColumnResize();if(options.enableColumnReorder){setupColumnReorder()}}function setupColumnSort(){$headers.click(function(e){if($(e.target).hasClass("slick-resizable-handle")){return}var $col=$(e.target).closest(".slick-header-column");if(!$col.length){return}var column=columns[getSiblingIndex($col[0])];if(column.sortable){if(!getEditorLock().commitCurrentEdit()){return}if(column.id===sortColumnId){sortAsc=!sortAsc}else{sortColumnId=column.id;sortAsc=true}setSortColumn(sortColumnId,sortAsc);self.onSort.notify({sortCol:column,sortAsc:sortAsc})}})}function setupColumnReorder(){$headers.sortable({containment:"parent",axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:true,start:function(e,ui){$(ui.helper).addClass("slick-header-column-active")},beforeStop:function(e,ui){$(ui.helper).removeClass("slick-header-column-active")},stop:function(e){if(!getEditorLock().commitCurrentEdit()){$(this).sortable("cancel");return}var reorderedIds=$headers.sortable("toArray");var reorderedColumns=[];for(var i=0;i<reorderedIds.length;i++){reorderedColumns.push(columns[getColumnIndex(reorderedIds[i].replace(uid,""))])}setColumns(reorderedColumns);self.onColumnsReordered.notify({});e.stopPropagation();setupColumnResize()}})}function setupColumnResize(){var $col,j,c,pageX,columnElements,minPageX,maxPageX,firstResizable,lastResizable,originalCanvasWidth;columnElements=$headers.children();columnElements.find(".slick-resizable-handle").remove();columnElements.each(function(i,e){if(columns[i].resizable){if(firstResizable===undefined){firstResizable=i}lastResizable=i}});columnElements.each(function(i,e){if((firstResizable!==undefined&&i<firstResizable)||(options.forceFitColumns&&i>=lastResizable)){return}$col=$(e);$("<div class='slick-resizable-handle' />").appendTo(e).bind("dragstart",function(e,dd){if(!getEditorLock().commitCurrentEdit()){return false}pageX=e.pageX;$(this).parent().addClass("slick-header-column-active");var shrinkLeewayOnRight=null,stretchLeewayOnRight=null;columnElements.each(function(i,e){columns[i].previousWidth=$(e).outerWidth()});if(options.forceFitColumns){shrinkLeewayOnRight=0;stretchLeewayOnRight=0;for(j=i+1;j<columnElements.length;j++){c=columns[j];if(c.resizable){if(stretchLeewayOnRight!==null){if(c.maxWidth){stretchLeewayOnRight+=c.maxWidth-c.previousWidth}else{stretchLeewayOnRight=null}}shrinkLeewayOnRight+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth)}}}var shrinkLeewayOnLeft=0,stretchLeewayOnLeft=0;for(j=0;j<=i;j++){c=columns[j];if(c.resizable){if(stretchLeewayOnLeft!==null){if(c.maxWidth){stretchLeewayOnLeft+=c.maxWidth-c.previousWidth}else{stretchLeewayOnLeft=null}}shrinkLeewayOnLeft+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth)}}if(shrinkLeewayOnRight===null){shrinkLeewayOnRight=100000}if(shrinkLeewayOnLeft===null){shrinkLeewayOnLeft=100000}if(stretchLeewayOnRight===null){stretchLeewayOnRight=100000}if(stretchLeewayOnLeft===null){stretchLeewayOnLeft=100000}maxPageX=pageX+Math.min(shrinkLeewayOnRight,stretchLeewayOnLeft);minPageX=pageX-Math.min(shrinkLeewayOnLeft,stretchLeewayOnRight);originalCanvasWidth=$canvas.width()}).bind("drag",function(e,dd){var actualMinWidth,d=Math.min(maxPageX,Math.max(minPageX,e.pageX))-pageX,x,ci;if(d<0){x=d;for(j=i;j>=0;j--){c=columns[j];if(c.resizable){actualMinWidth=Math.max(c.minWidth||0,absoluteColumnMinWidth);if(x&&c.previousWidth+x<actualMinWidth){x+=c.previousWidth-actualMinWidth;styleColumnWidth(j,actualMinWidth,options.syncColumnCellResize)}else{styleColumnWidth(j,c.previousWidth+x,options.syncColumnCellResize);x=0}}}if(options.forceFitColumns){x=-d;for(j=i+1;j<columnElements.length;j++){c=columns[j];if(c.resizable){if(x&&c.maxWidth&&(c.maxWidth-c.previousWidth<x)){x-=c.maxWidth-c.previousWidth;styleColumnWidth(j,c.maxWidth,options.syncColumnCellResize)}else{styleColumnWidth(j,c.previousWidth+x,options.syncColumnCellResize);x=0}}}}else{if(options.syncColumnCellResize){setCanvasWidth(originalCanvasWidth+d)}}}else{x=d;for(j=i;j>=0;j--){c=columns[j];if(c.resizable){if(x&&c.maxWidth&&(c.maxWidth-c.previousWidth<x)){x-=c.maxWidth-c.previousWidth;styleColumnWidth(j,c.maxWidth,options.syncColumnCellResize)}else{styleColumnWidth(j,c.previousWidth+x,options.syncColumnCellResize);x=0}}}if(options.forceFitColumns){x=-d;for(j=i+1;j<columnElements.length;j++){c=columns[j];if(c.resizable){actualMinWidth=Math.max(c.minWidth||0,absoluteColumnMinWidth);if(x&&c.previousWidth+x<actualMinWidth){x+=c.previousWidth-actualMinWidth;styleColumnWidth(j,actualMinWidth,options.syncColumnCellResize)}else{styleColumnWidth(j,c.previousWidth+x,options.syncColumnCellResize);x=0}}}}else{if(options.syncColumnCellResize){setCanvasWidth(originalCanvasWidth+d)}}}}).bind("dragend",function(e,dd){var newWidth;$(this).parent().removeClass("slick-header-column-active");for(j=0;j<columnElements.length;j++){c=columns[j];newWidth=$(columnElements[j]).outerWidth();if(c.previousWidth!==newWidth&&c.rerenderOnResize){invalidateAllRows()}if(options.forceFitColumns){c.width=Math.floor(c.width*(newWidth-c.previousWidth)/c.previousWidth)+c.width}else{c.width=newWidth}if(!options.syncColumnCellResize&&c.previousWidth!==newWidth){styleColumnWidth(j,newWidth,true)}}resizeCanvas();self.onColumnsResized.notify({})})})}function measureCellPaddingAndBorder(){var tmp=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers);headerColumnWidthDiff=tmp.outerWidth()-tmp.width();headerColumnHeightDiff=tmp.outerHeight()-tmp.height();tmp.remove();var r=$("<div class='slick-row' />").appendTo($canvas);tmp=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(r);cellWidthDiff=tmp.outerWidth()-tmp.width();cellHeightDiff=tmp.outerHeight()-tmp.height();r.remove();absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));var rowHeight=(options.rowHeight-cellHeightDiff);var rules=["."+uid+" .slick-header-column { left: 10000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-cell { height:"+rowHeight+"px; }"];for(var i=0;i<columns.length;i++){rules.push("."+uid+" .c"+i+" { width:"+((columns[i].currentWidth||columns[i].width)-cellWidthDiff)+"px;  } ")}if($style[0].styleSheet){$style[0].styleSheet.cssText=rules.join("")}else{$style[0].appendChild(document.createTextNode(rules.join(" ")))}var sheets=document.styleSheets;for(var i=0;i<sheets.length;i++){if((sheets[i].ownerNode||sheets[i].owningElement)==$style[0]){stylesheet=sheets[i];break}}}function findCssRule(selector){var rules=(stylesheet.cssRules||stylesheet.rules);for(var i=0;i<rules.length;i++){if(rules[i].selectorText==selector){return rules[i]}}return null}function findCssRuleForCell(index){return findCssRule("."+uid+" .c"+index)}function removeCssRules(){$style.remove()}function destroy(){getEditorLock().cancelCurrentEdit();self.onBeforeDestroy.notify({});for(var i=0;i<plugins.length;i++){unregisterPlugin(plugin)}if(options.enableColumnReorder&&$headers.sortable){$headers.sortable("destroy")}unbindAncestorScrollEvents();$container.unbind(".slickgrid");removeCssRules();$canvas.unbind("draginit dragstart dragend drag");$container.empty().removeClass(uid)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(id){return columnsById[id]}function autosizeColumns(){var i,c,widths=[],shrinkLeeway=0,viewportW=$viewport.innerWidth(),availWidth=(options.autoHeight?viewportW:viewportW-scrollbarDimensions.width),total=0,existingTotal=0;for(i=0;i<columns.length;i++){c=columns[i];widths.push(c.width);existingTotal+=c.width;shrinkLeeway+=c.width-Math.max(c.minWidth||0,absoluteColumnMinWidth)}total=existingTotal;invalidateAllRows();while(total>availWidth){if(!shrinkLeeway){return}var shrinkProportion=(total-availWidth)/shrinkLeeway;for(i=0;i<columns.length&&total>availWidth;i++){c=columns[i];if(!c.resizable||c.minWidth===c.width||c.width===absoluteColumnMinWidth){continue}var shrinkSize=Math.floor(shrinkProportion*(c.width-Math.max(c.minWidth||0,absoluteColumnMinWidth)))||1;total-=shrinkSize;widths[i]-=shrinkSize}}var previousTotal=total;while(total<availWidth){var growProportion=availWidth/total;for(i=0;i<columns.length&&total<availWidth;i++){c=columns[i];if(!c.resizable||c.maxWidth<=c.width){continue}var growSize=Math.min(Math.floor(growProportion*c.width)-c.width,(c.maxWidth-c.width)||1000000)||1;total+=growSize;widths[i]+=growSize}if(previousTotal==total){break}previousTotal=total}for(i=0;i<columns.length;i++){styleColumnWidth(i,columns[i].currentWidth=widths[i],true)}resizeCanvas()}function styleColumnWidth(index,width,styleCells){columns[index].currentWidth=width;$headers.children().eq(index).css("width",width-headerColumnWidthDiff);if(styleCells){findCssRuleForCell(index).style.width=(width-cellWidthDiff)+"px"}}function setSortColumn(columnId,ascending){sortColumnId=columnId;sortAsc=ascending;var columnIndex=getColumnIndex(sortColumnId);$headers.children().removeClass("slick-header-column-sorted");$headers.find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc");if(columnIndex!=null){$headers.children().eq(columnIndex).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc")}}function handleSelectedRangesChanged(e,ranges){selectedRows=[];var hash={};for(var i=0;i<ranges.length;i++){for(var j=ranges[i].fromRow;j<=ranges[i].toRow;j++){if(!hash[j]){selectedRows.push(j)}hash[j]={};for(var k=ranges[i].fromCell;k<=ranges[i].toCell;k++){hash[j][columns[k].id]=options.selectedCellCssClass}}}setCellCssStyles(options.selectedCellCssClass,hash);self.onSelectedRowsChanged.notify(e,getSelectedRows())}function getColumns(){return columns}function setColumns(columnDefinitions){columns=columnDefinitions;invalidateAllRows();createColumnHeaders();removeCssRules();createCssRules();resizeAndRender();handleScroll()}function getOptions(){return options}function setOptions(args){if(!getEditorLock().commitCurrentEdit()){return}makeActiveCellNormal();if(options.enableAddRow!==args.enableAddRow){invalidateRow(getDataLength())}options=$.extend(options,args);render()}function setData(newData,scrollToTop){invalidateAllRows();gridData=newData;if(scrollToTop){scrollTo(0)}}function getData(){return gridData}function getDataLength(){if(gridData.getLength){return gridData.getLength()}else{return gridData.length}}function getDataItem(i){if(gridData.getItem){return gridData.getItem(i)}else{return gridData[i]}}function getTopPanel(){return $topPanel[0]}function showTopPanel(){options.showTopPanel=true;$topPanelScroller.slideDown("fast",resizeCanvas)}function hideTopPanel(){options.showTopPanel=false;$topPanelScroller.slideUp("fast",resizeCanvas)}function showHeaderRowColumns(){options.showHeaderRow=true;$headerRowScroller.slideDown("fast",resizeCanvas)}function hideHeaderRowColumns(){options.showHeaderRow=false;$headerRowScroller.slideUp("fast",resizeCanvas)}function scrollTo(y){var oldOffset=offset;page=Math.min(n-1,Math.floor(y/ph));offset=Math.round(page*cj);var newScrollTop=y-offset;if(offset!=oldOffset){var range=getVisibleRange(newScrollTop);cleanupRows(range.top,range.bottom);updateRowPositions()}if(prevScrollTop!=newScrollTop){scrollDir=(prevScrollTop+oldOffset<newScrollTop+offset)?1:-1;$viewport[0].scrollTop=(lastRenderedScrollTop=scrollTop=prevScrollTop=newScrollTop);self.onViewportChanged.notify({})}}function defaultFormatter(row,cell,value,columnDef,dataContext){return(value===null||value===undefined)?"":value}function getFormatter(column){return column.formatter||(options.formatterFactory&&options.formatterFactory.getFormatter(column))||defaultFormatter}function getEditor(column){return column.editor||(options.editorFactory&&options.editorFactory.getEditor(column))}function appendRowHtml(stringArray,row){var d=getDataItem(row);var dataLoading=row<getDataLength()&&!d;var cellCss;var css="slick-row "+(dataLoading?" loading":"")+(row%2==1?" odd":" even");if(options.rowCssClasses){css+=" "+options.rowCssClasses(d)}stringArray.push("<div class='ui-widget-content "+css+"' row='"+row+"' style='top:"+(options.rowHeight*row-offset)+"px'>");for(var i=0,cols=columns.length;i<cols;i++){var m=columns[i];cellCss="slick-cell c"+i+(m.cssClass?" "+m.cssClass:"");for(var key in cellCssClasses){if(cellCssClasses[key][row]&&cellCssClasses[key][row][m.id]){cellCss+=(" "+cellCssClasses[key][row][m.id])}}stringArray.push("<div class='"+cellCss+"'>");if(d){stringArray.push(getFormatter(m)(row,i,d[m.field],m,d))}stringArray.push("</div>")}stringArray.push("</div>")}function cleanupRows(rangeToKeep){for(var i in rowsCache){if(((i=parseInt(i,10))!==activeRow)&&(i<rangeToKeep.top||i>rangeToKeep.bottom)){removeRowFromCache(i)}}}function invalidate(){updateRowCount();invalidateAllRows();render()}function invalidateAllRows(){if(currentEditor){makeActiveCellNormal()}for(var row in rowsCache){removeRowFromCache(row)}}function removeRowFromCache(row){var node=rowsCache[row];if(!node){return}$canvas[0].removeChild(node);delete rowsCache[row];delete postProcessedRows[row];renderedRows--;counter_rows_removed++}function invalidateRows(rows){var i,rl;if(!rows||!rows.length){return}scrollDir=0;for(i=0,rl=rows.length;i<rl;i++){if(currentEditor&&activeRow===i){makeActiveCellNormal()}if(rowsCache[rows[i]]){removeRowFromCache(rows[i])}}}function invalidateRow(row){invalidateRows([row])}function updateCell(row,cell){var cellNode=getCellNode(row,cell);if(!cellNode){return}var m=columns[cell],d=getDataItem(row);if(currentEditor&&activeRow===row&&activeCell===cell){currentEditor.loadValue(d)}else{cellNode.innerHTML=d?getFormatter(m)(row,cell,d[m.field],m,d):"";invalidatePostProcessingResults(row)}}function updateRow(row){if(!rowsCache[row]){return}$(rowsCache[row]).children().each(function(i){var m=columns[i];if(row===activeRow&&i===activeCell&&currentEditor){currentEditor.loadValue(getDataItem(activeRow))}else{if(getDataItem(row)){this.innerHTML=getFormatter(m)(row,i,getDataItem(row)[m.field],m,getDataItem(row))}else{this.innerHTML=""}}});invalidatePostProcessingResults(row)}function resizeViewport(){$viewport.height($container.innerHeight()-$headerScroller.outerHeight()-(options.showTopPanel?$topPanelScroller.outerHeight():0)-(options.showHeaderRow?$headerRow.outerHeight():0))}function resizeCanvas(){var newViewportH=options.rowHeight*(getDataLength()+(options.enableAddRow?1:0)+(options.leaveSpaceForNewRows?numVisibleRows-1:0));if(options.autoHeight){$viewport.height(newViewportH)}else{resizeViewport()}viewportW=$viewport.innerWidth();viewportH=$viewport.innerHeight();numVisibleRows=Math.ceil(viewportH/options.rowHeight);var totalWidth=0;$headers.find(".slick-header-column").each(function(){totalWidth+=$(this).outerWidth()});setCanvasWidth(totalWidth);updateRowCount();render()}function resizeAndRender(){if(options.forceFitColumns){autosizeColumns()}else{resizeCanvas()}}function updateRowCount(){var newRowCount=getDataLength()+(options.enableAddRow?1:0)+(options.leaveSpaceForNewRows?numVisibleRows-1:0);var oldH=h;var l=options.enableAddRow?getDataLength():getDataLength()-1;for(var i in rowsCache){if(i>=l){removeRowFromCache(i)}}th=Math.max(options.rowHeight*newRowCount,viewportH-scrollbarDimensions.height);if(th<maxSupportedCssHeight){h=ph=th;n=1;cj=0}else{h=maxSupportedCssHeight;ph=h/100;n=Math.floor(th/ph);cj=(th-h)/(n-1)}if(h!==oldH){$canvas.css("height",h);scrollTop=$viewport[0].scrollTop}var oldScrollTopInRange=(scrollTop+offset<=th-viewportH);if(th==0||scrollTop==0){page=offset=0}else{if(oldScrollTopInRange){scrollTo(scrollTop+offset)}else{scrollTo(th-viewportH)}}if(h!=oldH&&options.autoHeight){resizeCanvas()}}function getVisibleRange(viewportTop){if(viewportTop==null){viewportTop=scrollTop}return{top:Math.floor((scrollTop+offset)/options.rowHeight),bottom:Math.ceil((scrollTop+offset+viewportH)/options.rowHeight)}}function getRenderedRange(viewportTop){var range=getVisibleRange(viewportTop);var buffer=Math.round(viewportH/options.rowHeight);var minBuffer=3;if(scrollDir==-1){range.top-=buffer;range.bottom+=minBuffer}else{if(scrollDir==1){range.top-=minBuffer;range.bottom+=buffer}else{range.top-=minBuffer;range.bottom+=minBuffer}}range.top=Math.max(0,range.top);range.bottom=Math.min(options.enableAddRow?getDataLength():getDataLength()-1,range.bottom);return range}function renderRows(range){var i,l,parentNode=$canvas[0],rowsBefore=renderedRows,stringArray=[],rows=[],startTimestamp=new Date(),needToReselectCell=false;for(i=range.top;i<=range.bottom;i++){if(rowsCache[i]){continue}renderedRows++;rows.push(i);appendRowHtml(stringArray,i);if(activeCellNode&&activeRow===i){needToReselectCell=true}counter_rows_rendered++}var x=document.createElement("div");x.innerHTML=stringArray.join("");for(i=0,l=x.childNodes.length;i<l;i++){rowsCache[rows[i]]=parentNode.appendChild(x.firstChild)}if(needToReselectCell){setActiveCellInternal(getCellNode(activeRow,activeCell),false)}if(renderedRows-rowsBefore>5){avgRowRenderTime=(new Date()-startTimestamp)/(renderedRows-rowsBefore)}}function startPostProcessing(){if(!options.enableAsyncPostRender){return}clearTimeout(h_postrender);h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay)}function invalidatePostProcessingResults(row){delete postProcessedRows[row];postProcessFromRow=Math.min(postProcessFromRow,row);postProcessToRow=Math.max(postProcessToRow,row);startPostProcessing()}function updateRowPositions(){for(var row in rowsCache){rowsCache[row].style.top=(row*options.rowHeight-offset)+"px"}}function render(){var visible=getVisibleRange();var rendered=getRenderedRange();cleanupRows(rendered);renderRows(rendered);postProcessFromRow=visible.top;postProcessToRow=Math.min(options.enableAddRow?getDataLength():getDataLength()-1,visible.bottom);startPostProcessing();lastRenderedScrollTop=scrollTop;h_render=null}function handleScroll(){scrollTop=$viewport[0].scrollTop;var scrollLeft=$viewport[0].scrollLeft;var scrollDist=Math.abs(scrollTop-prevScrollTop);if(scrollLeft!==prevScrollLeft){prevScrollLeft=scrollLeft;$headerScroller[0].scrollLeft=scrollLeft;$topPanelScroller[0].scrollLeft=scrollLeft;$headerRowScroller[0].scrollLeft=scrollLeft}if(scrollDist){scrollDir=prevScrollTop<scrollTop?1:-1;prevScrollTop=scrollTop;if(scrollDist<viewportH){scrollTo(scrollTop+offset)}else{var oldOffset=offset;page=Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph)));offset=Math.round(page*cj);if(oldOffset!=offset){invalidateAllRows()}}if(h_render){clearTimeout(h_render)}if(Math.abs(lastRenderedScrollTop-scrollTop)<viewportH){render()}else{h_render=setTimeout(render,50)}self.onViewportChanged.notify({})}self.onScroll.notify({scrollLeft:scrollLeft,scrollTop:scrollTop})}function asyncPostProcessRows(){while(postProcessFromRow<=postProcessToRow){var row=(scrollDir>=0)?postProcessFromRow++:postProcessToRow--;var rowNode=rowsCache[row];if(!rowNode||postProcessedRows[row]||row>=getDataLength()){continue}var d=getDataItem(row),cellNodes=rowNode.childNodes;for(var i=0,j=0,l=columns.length;i<l;++i){var m=columns[i];if(m.asyncPostRender){m.asyncPostRender(cellNodes[j],postProcessFromRow,d,m)}++j}postProcessedRows[row]=true;h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay);return}}function addCellCssStyles(key,hash){if(cellCssClasses[key]){throw"addCellCssStyles: cell CSS hash with key '"+key+"' already exists."}cellCssClasses[key]=hash;for(var row in rowsCache){if(hash[row]){for(var columnId in hash[row]){$(rowsCache[row]).children().eq(getColumnIndex(columnId)).addClass(hash[row][columnId])}}}}function removeCellCssStyles(key){if(!cellCssClasses[key]){return}for(var row in rowsCache){if(cellCssClasses[key][row]){for(var columnId in cellCssClasses[key][row]){$(rowsCache[row]).children().eq(getColumnIndex(columnId)).removeClass(cellCssClasses[key][row][columnId])}}}delete cellCssClasses[key]}function setCellCssStyles(key,hash){removeCellCssStyles(key);addCellCssStyles(key,hash)}function flashCell(row,cell,speed){speed=speed||100;if(rowsCache[row]){var $cell=$(getCellNode(row,cell));function toggleCellClass(times){if(!times){return}setTimeout(function(){$cell.queue(function(){$cell.toggleClass(options.cellFlashingCssClass).dequeue();toggleCellClass(times-1)})},speed)}toggleCellClass(4)}}function getSiblingIndex(node){var idx=0;while(node&&node.previousSibling){idx++;node=node.previousSibling}return idx}function handleDragInit(e,dd){var cell=getCellFromEvent(e);if(!cell||!cellExists(cell.row,cell.cell)){return false}retval=self.onDragInit.notify(e,dd);if(e.isImmediatePropagationStopped()){return retval}}function handleDragStart(e,dd){var cell=getCellFromEvent(e);if(!cell||!cellExists(cell.row,cell.cell)){return false}var retval=self.onDragStart.notify(e,dd);if(e.isImmediatePropagationStopped()){return retval}return false}function handleDrag(e,dd){return self.onDrag.notify(e,dd)}function handleDragEnd(e,dd){self.onDragEnd.notify(e,dd)}function handleKeyDown(e){self.onKeyDown.notify(e,{});var handled=e.isImmediatePropagationStopped();if(!handled){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey){if(e.which==27){if(!getEditorLock().isActive()){return}cancelEditAndSetFocus()}else{if(e.which==37){navigateLeft()}else{if(e.which==39){navigateRight()}else{if(e.which==38){navigateUp()}else{if(e.which==40){navigateDown()}else{if(e.which==9){navigateNext()}else{if(e.which==13){if(options.editable){if(currentEditor){if(activeRow===getDataLength()){navigateDown()}else{commitEditAndSetFocus()}}else{if(getEditorLock().commitCurrentEdit()){makeActiveCellEditable()}}}}else{return}}}}}}}}else{if(e.which==9&&e.shiftKey&&!e.ctrlKey&&!e.altKey){navigatePrev()}else{return}}}e.stopPropagation();e.preventDefault();try{e.originalEvent.keyCode=0}catch(error){}}function handleClick(e){var cell=getCellFromEvent(e);if(!cell||(currentEditor!==null&&activeRow==cell.row&&activeCell==cell.cell)){return}self.onClick.notify(e,{row:cell.row,cell:cell.cell});if(e.isImmediatePropagationStopped()){return}if(options.enableCellNavigation&&!columns[cell.cell].unselectable){if(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit()){scrollRowIntoView(cell.row,false);setActiveCellInternal(getCellNode(cell.row,cell.cell),(cell.row===getDataLength())||options.autoEdit)}}}function handleContextMenu(e){var $cell=$(e.target).closest(".slick-cell",$canvas);if($cell.length===0){return}if(activeCellNode===$cell[0]&&currentEditor!==null){return}self.onContextMenu.notify(e,{})}function handleDblClick(e){var cell=getCellFromEvent(e);if(!cell||(currentEditor!==null&&activeRow==cell.row&&activeCell==cell.cell)){return}self.onDblClick.notify(e,{row:cell.row,cell:cell.cell});if(e.isImmediatePropagationStopped()){return}if(options.editable){gotoCell(cell.row,cell.cell,true)}}function handleHeaderContextMenu(e){var $header=$(e.target).closest(".slick-header-column",".slick-header-columns");var column=$header&&columns[self.getColumnIndex($header.data("fieldId"))];self.onHeaderContextMenu.notify(e,{column:column})}function handleHeaderClick(e){var $header=$(e.target).closest(".slick-header-column",".slick-header-columns");var column=$header&&columns[self.getColumnIndex($header.data("fieldId"))];self.onHeaderClick.notify(e,{column:column})}function handleMouseEnter(e){self.onMouseEnter.notify(e,{})}function handleMouseLeave(e){self.onMouseLeave.notify(e,{})}function cellExists(row,cell){return !(row<0||row>=getDataLength()||cell<0||cell>=columns.length)}function getCellFromPoint(x,y){var row=Math.floor((y+offset)/options.rowHeight);var cell=0;var w=0;for(var i=0;i<columns.length&&w<x;i++){w+=(columns[i].currentWidth||columns[i].width);cell++}if(cell<0){cell=0}return{row:row,cell:cell-1}}function getCellFromEvent(e){var $cell=$(e.target).closest(".slick-cell",$canvas);if(!$cell.length){return null}return{row:$cell.parent().attr("row")|0,cell:getSiblingIndex($cell[0])}}function getCellNodeBox(row,cell){if(!cellExists(row,cell)){return null}var y1=row*options.rowHeight-offset;var y2=y1+options.rowHeight-1;var x1=0;for(var i=0;i<cell;i++){x1+=(columns[i].currentWidth||columns[i].width)}var x2=x1+(columns[cell].currentWidth||columns[cell].width);return{top:y1,left:x1,bottom:y2,right:x2}}function resetActiveCell(){setActiveCellInternal(null,false)}function focusOnActiveCell(){$(activeCellNode).attr("tabIndex",0).attr("hideFocus",true);if($.browser.msie&&parseInt($.browser.version)<8){activeCellNode.setActive()}else{activeCellNode.focus()}var left=$(activeCellNode).position().left,right=left+$(activeCellNode).outerWidth(),scrollLeft=$viewport.scrollLeft(),scrollRight=scrollLeft+$viewport.width();if(left<scrollLeft){$viewport.scrollLeft(left)}else{if(right>scrollRight){$viewport.scrollLeft(Math.min(left,right-$viewport[0].clientWidth))}}}function setActiveCellInternal(newCell,editMode){if(activeCellNode!==null){makeActiveCellNormal();$(activeCellNode).removeClass("active")}var activeCellChanged=(activeCellNode!==newCell);activeCellNode=newCell;if(activeCellNode!=null){activeRow=parseInt($(activeCellNode).parent().attr("row"),10);activeCell=getSiblingIndex(activeCellNode);$(activeCellNode).addClass("active");if(options.editable&&editMode&&isCellPotentiallyEditable(activeRow,activeCell)){clearTimeout(h_editorLoader);if(options.asyncEditorLoading){h_editorLoader=setTimeout(makeActiveCellEditable,options.asyncEditorLoadDelay)}else{makeActiveCellEditable()}}else{focusOnActiveCell()}}else{activeRow=null;activeCell=null}if(activeCellChanged){self.onActiveCellChanged.notify(getActiveCell())}}function clearTextSelection(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var sel=window.getSelection();if(sel&&sel.removeAllRanges){sel.removeAllRanges()}}}}function isCellPotentiallyEditable(row,cell){if(row<getDataLength()&&!getDataItem(row)){return false}if(columns[cell].cannotTriggerInsert&&row>=getDataLength()){return false}if(!getEditor(columns[cell])){return false}return true}function makeActiveCellNormal(){if(!currentEditor){return}self.onBeforeCellEditorDestroy.notify({editor:currentEditor});currentEditor.destroy();currentEditor=null;if(activeCellNode){$(activeCellNode).removeClass("editable invalid");if(getDataItem(activeRow)){var column=columns[activeCell];activeCellNode.innerHTML=getFormatter(column)(activeRow,activeCell,getDataItem(activeRow)[column.field],column,getDataItem(activeRow));invalidatePostProcessingResults(activeRow)}}if($.browser.msie){clearTextSelection()}getEditorLock().deactivate(editController)}function makeActiveCellEditable(){if(!activeCellNode){return}if(!options.editable){throw"Grid : makeActiveCellEditable : should never get called when options.editable is false"}clearTimeout(h_editorLoader);if(!isCellPotentiallyEditable(activeRow,activeCell)){return}if(self.onBeforeEditCell.notify({row:activeRow,cell:activeCell,item:getDataItem(activeRow)})===false){focusOnActiveCell();return}getEditorLock().activate(editController);$(activeCellNode).addClass("editable");activeCellNode.innerHTML="";var columnDef=columns[activeCell];var item=getDataItem(activeRow);currentEditor=new (getEditor(columnDef))({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:columnDef,item:item||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus});if(item){currentEditor.loadValue(item)}serializedEditorValue=currentEditor.serializeValue();if(currentEditor.position){handleActiveCellPositionChange()}}function commitEditAndSetFocus(){if(getEditorLock().commitCurrentEdit()){focusOnActiveCell();if(options.autoEdit){navigateDown()}}}function cancelEditAndSetFocus(){if(getEditorLock().cancelCurrentEdit()){focusOnActiveCell()}}function absBox(elem){var box={top:elem.offsetTop,left:elem.offsetLeft,bottom:0,right:0,width:$(elem).outerWidth(),height:$(elem).outerHeight(),visible:true};box.bottom=box.top+box.height;box.right=box.left+box.width;var offsetParent=elem.offsetParent;while((elem=elem.parentNode)!=document.body){if(box.visible&&elem.scrollHeight!=elem.offsetHeight&&$(elem).css("overflowY")!="visible"){box.visible=box.bottom>elem.scrollTop&&box.top<elem.scrollTop+elem.clientHeight}if(box.visible&&elem.scrollWidth!=elem.offsetWidth&&$(elem).css("overflowX")!="visible"){box.visible=box.right>elem.scrollLeft&&box.left<elem.scrollLeft+elem.clientWidth}box.left-=elem.scrollLeft;box.top-=elem.scrollTop;if(elem===offsetParent){box.left+=elem.offsetLeft;box.top+=elem.offsetTop;offsetParent=elem.offsetParent}box.bottom=box.top+box.height;box.right=box.left+box.width}return box}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(!activeCellNode){return}var cellBox;self.onActiveCellPositionChanged.notify({});if(currentEditor){cellBox=cellBox||getActiveCellPosition();if(currentEditor.show&&currentEditor.hide){if(!cellBox.visible){currentEditor.hide()}else{currentEditor.show()}}if(currentEditor.position){currentEditor.position(cellBox)}}}function getCellEditor(){return currentEditor}function getActiveCell(){if(!activeCellNode){return null}else{return{row:activeRow,cell:activeCell}}}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(row,doPaging){var rowAtTop=row*options.rowHeight;var rowAtBottom=(row+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);if((row+1)*options.rowHeight>scrollTop+viewportH+offset){scrollTo(doPaging?rowAtTop:rowAtBottom);render()}else{if(row*options.rowHeight<scrollTop+offset){scrollTo(doPaging?rowAtBottom:rowAtTop);render()}}}function gotoDir(dy,dx,rollover){if(!activeCellNode||!options.enableCellNavigation){return}if(!getEditorLock().commitCurrentEdit()){return}function selectableCellFilter(){return !columns[getSiblingIndex(this)].unselectable}var nextRow=rowsCache[activeRow+dy];var nextCell=(nextRow&&activeCell+dx>=0)?$(nextRow).children().eq(activeCell+dx).filter(selectableCellFilter):null;if(nextCell&&!nextCell.length){var nodes=$(nextRow).children().filter(function(index){return(dx>0)?index>activeCell+dx:index<activeCell+dx}).filter(selectableCellFilter);if(nodes&&nodes.length){nextCell=(dx>0)?nodes.eq(0):nodes.eq(nodes.length-1)}}if(rollover&&dy===0&&!(nextRow&&nextCell&&nextCell.length)){if(!nextCell||!nextCell.length){nextRow=rowsCache[activeRow+dy+((dx>0)?1:-1)];var nodes=$(nextRow).children().filter(selectableCellFilter);if(dx>0){nextCell=nextRow?nodes.eq(0):null}else{nextCell=nextRow?nodes.eq(nodes.length-1):null}}}if(nextRow&&nextCell&&nextCell.length){var row=parseInt($(nextRow).attr("row"),10);var isAddNewRow=(row==getDataLength());scrollRowIntoView(row,!isAddNewRow);setActiveCellInternal(nextCell[0],isAddNewRow||options.autoEdit);if(!currentEditor){focusOnActiveCell()}}else{focusOnActiveCell()}}function getCellNode(row,cell){if(rowsCache[row]){return $(rowsCache[row]).children().eq(cell)[0]}return null}function setActiveCell(row,cell){if(row>getDataLength()||row<0||cell>=columns.length||cell<0){return}if(!options.enableCellNavigation){return}scrollRowIntoView(row,false);setActiveCellInternal(getCellNode(row,cell),false)}function canCellBeSelected(row,cell){return row<getDataLength()&&row>=0&&cell<columns.length&&cell>=0&&!columns[cell].unselectable}function gotoCell(row,cell,forceEdit){if(row>getDataLength()||row<0||cell>=columns.length||cell<0){return}if(!options.enableCellNavigation||columns[cell].unselectable){return}if(!getEditorLock().commitCurrentEdit()){return}scrollRowIntoView(row,false);var newCell=null;if(!columns[cell].unselectable){newCell=getCellNode(row,cell)}setActiveCellInternal(newCell,forceEdit||(row===getDataLength())||options.autoEdit);if(!currentEditor){focusOnActiveCell()}}function navigateUp(){gotoDir(-1,0,false)}function navigateDown(){gotoDir(1,0,false)}function navigateLeft(){gotoDir(0,-1,false)}function navigateRight(){gotoDir(0,1,false)}function navigatePrev(){gotoDir(0,-1,true)}function navigateNext(){gotoDir(0,1,true)}function commitCurrentEdit(){var item=getDataItem(activeRow);var column=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var validationResults=currentEditor.validate();if(validationResults.valid){if(activeRow<getDataLength()){var editCommand={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(item,this.serializedValue);updateRow(this.row)},undo:function(){this.editor.applyValue(item,this.prevSerializedValue);updateRow(this.row)}};if(options.editCommandHandler){makeActiveCellNormal();options.editCommandHandler(item,column,editCommand)}else{editCommand.execute();makeActiveCellNormal()}self.onCellChange.notify({row:activeRow,cell:activeCell,item:item})}else{var newItem={};currentEditor.applyValue(newItem,currentEditor.serializeValue());makeActiveCellNormal();self.onAddNewRow.notify({item:newItem,column:column})}return !getEditorLock().isActive()}else{$(activeCellNode).addClass("invalid");$(activeCellNode).stop(true,true).effect("highlight",{color:"red"},300);self.onValidationError.notify({cellNode:activeCellNode,validationResults:validationResults,row:activeRow,cell:activeCell,column:column});currentEditor.focus();return false}}makeActiveCellNormal()}return true}function cancelCurrentEdit(){makeActiveCellNormal();return true}function rowsToRanges(rows){var ranges=[];var lastCell=columns.length-1;for(var i=0;i<rows.length;i++){ranges.push(new Slick.Range(rows[i],0,rows[i],lastCell))}return ranges}function getSelectedRows(){if(!selectionModel){throw"Selection model is not set"}return selectedRows}function setSelectedRows(rows){if(!selectionModel){throw"Selection model is not set"}selectionModel.setSelectedRanges(rowsToRanges(rows))}this.debug=function(){var s="";s+=("\ncounter_rows_rendered:  "+counter_rows_rendered);s+=("\ncounter_rows_removed:  "+counter_rows_removed);s+=("\nrenderedRows:  "+renderedRows);s+=("\nnumVisibleRows:  "+numVisibleRows);s+=("\nmaxSupportedCssHeight:  "+maxSupportedCssHeight);s+=("\nn(umber of pages):  "+n);s+=("\n(current) page:  "+page);s+=("\npage height (ph):  "+ph);s+=("\nscrollDir:  "+scrollDir);alert(s)};this.eval=function(expr){return eval(expr)};$.extend(this,{slickGridVersion:"2.0a1",onScroll:new Slick.Event(),onSort:new Slick.Event(),onHeaderContextMenu:new Slick.Event(),onHeaderClick:new Slick.Event(),onMouseEnter:new Slick.Event(),onMouseLeave:new Slick.Event(),onClick:new Slick.Event(),onDblClick:new Slick.Event(),onContextMenu:new Slick.Event(),onKeyDown:new Slick.Event(),onAddNewRow:new Slick.Event(),onValidationError:new Slick.Event(),onViewportChanged:new Slick.Event(),onColumnsReordered:new Slick.Event(),onColumnsResized:new Slick.Event(),onCellChange:new Slick.Event(),onBeforeEditCell:new Slick.Event(),onBeforeCellEditorDestroy:new Slick.Event(),onBeforeDestroy:new Slick.Event(),onActiveCellChanged:new Slick.Event(),onActiveCellPositionChanged:new Slick.Event(),onDragInit:new Slick.Event(),onDragStart:new Slick.Event(),onDrag:new Slick.Event(),onDragEnd:new Slick.Event(),onSelectedRowsChanged:new Slick.Event(),registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,getCanvasNode:getCanvasNode,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,gotoCell:gotoCell,getTopPanel:getTopPanel,showTopPanel:showTopPanel,hideTopPanel:hideTopPanel,showHeaderRowColumns:showHeaderRowColumns,hideHeaderRowColumns:hideHeaderRowColumns,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController});init()}}(jQuery));(function(a){function b(){var i=this;var D="id";var s=[];var H=[];var k={};var r=null;var z=null;var e=null;var u=false;var J=true;var f=null;var j=null;var C=0;var v=0;var A=0;var d=new Slick.Event();var g=new Slick.Event();var c=new Slick.Event();function l(){u=true}function O(){u=false;M()}function L(){k={};for(var Q=0,P=s.length;Q<P;Q++){var R=s[Q][D];if(R==undefined||k[R]!=undefined){throw"Each data element must implement a unique 'id' property"}k[R]=Q}}function q(){return s}function m(Q,P){if(P!==undefined){D=P}s=Q;L();M()}function o(P){if(P.pageSize!=undefined){C=P.pageSize}if(P.pageNum!=undefined){v=Math.min(P.pageNum,Math.ceil(A/C))}c.notify(G());M()}function G(){return{pageSize:C,pageNum:v,totalRows:A}}function K(Q,P){J=P;f=Q;j=null;if(P===false){s.reverse()}s.sort(Q);if(P===false){s.reverse()}L();M()}function x(R,Q){J=Q;j=R;f=null;var P=Object.prototype.toString;Object.prototype.toString=(typeof R=="function")?R:function(){return this[R]};if(Q===false){s.reverse()}s.sort();Object.prototype.toString=P;if(Q===false){s.reverse()}L();M()}function N(){if(f){K(f,J)}else{if(j){x(j,J)}}}function p(P){z=P;M()}function w(P){return s[P]}function B(P){return k[P]}function y(R){if(!r){r={};for(var Q=0,P=H.length;Q<P;++Q){r[H[Q][D]]=Q}}return r[R]}function F(P){return s[k[P]]}function E(Q,P){if(k[Q]===undefined||Q!==P[D]){throw"Invalid or non-matching id"}s[k[Q]]=P;if(!e){e={}}e[Q]=true;M()}function t(P,Q){s.splice(P,0,Q);L();M()}function I(P){s.push(P);L();M()}function h(P){if(k[P]===undefined){throw"Invalid id"}s.splice(k[P],1);L();M()}function n(ab,Y,V,R){var ac=[];var X=ab,ae=Y,Q=V,T=R;r=null;var W=ae.length;var U=0;var aa=0;var ad,P;for(var S=0,Z=X.length;S<Z;++S){ad=X[S];if(!Q||Q(ad)){P=ad[D];if(!C||(U>=C*v&&U<C*(v+1))){if(aa>=W||P!=ae[aa][D]||(T&&T[P])){ac[ac.length]=aa;ae[aa]=ad}aa++}U++}}if(W>aa){ae.splice(aa,W-aa)}A=U;return ac}function M(){if(u){return}var P=H.length;var Q=A;var R=n(s,H,z,e);if(C&&A<v*C){v=Math.floor(A/C);R=n(s,H,z,e)}e=null;if(Q!=A){c.notify(G())}if(P!=H.length){d.notify({previous:P,current:H.length})}if(R.length>0){g.notify(R)}}return{rows:H,beginUpdate:l,endUpdate:O,setPagingOptions:o,getPagingInfo:G,getItems:q,setItems:m,setFilter:p,sort:K,fastSort:x,reSort:N,getIdxById:B,getRowById:y,getItemById:F,getItemByIdx:w,refresh:M,updateItem:E,insertItem:t,addItem:I,deleteItem:h,onRowCountChanged:d,onRowsChanged:g,onPagingInfoChanged:c}}a.extend(true,window,{Slick:{Data:{DataView:b}}})})(jQuery);